// (C) 2017-2022 by folkert van heusden, released under Apache License v2.0
#include "config.h"
#include <string>
#include <cstring>
#include <time.h>

#include "gen.h"
#include "feed.h"
#include "filter_add_text.h"
#include "error.h"
#include "instance.h"
#include "utils.h"
#include "view.h"
#include "exec.h"

constexpr unsigned char font[128][8][8] = {
	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 255, 255, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 255, 0 },
		{ 255, 0, 255, 0, 0, 255, 0, 255 },
		{ 255, 0, 0, 0, 0, 0, 0, 255 },
		{ 255, 0, 255, 0, 0, 255, 0, 255 },
		{ 255, 0, 0, 255, 255, 0, 0, 255 },
		{ 0, 255, 0, 0, 0, 0, 255, 0 },
		{ 0, 0, 255, 255, 255, 255, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 255, 255, 0, 0 },
		{ 0, 255, 255, 255, 255, 255, 255, 0 },
		{ 255, 255, 0, 255, 255, 0, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 0, 255, 255, 0, 255, 255 },
		{ 0, 255, 255, 0, 0, 255, 255, 0 },
		{ 0, 0, 255, 255, 255, 255, 0, 0 }
	},

	{
		{ 0, 255, 255, 0, 255, 255, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 0, 255, 255, 255, 255, 255, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 255, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 0, 255, 255, 255, 255, 255, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 255, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 0, 255, 0, 255, 0, 255, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 255, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 255, 0, 0, 255, 255, 255 },
		{ 255, 255, 255, 0, 0, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 }
	},

	{
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 255, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 255, 0 },
		{ 255, 0, 0, 0, 0, 0, 255, 0 },
		{ 255, 0, 0, 0, 0, 0, 255, 0 },
		{ 0, 255, 0, 0, 0, 255, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 0, 0, 0, 255, 255, 255 },
		{ 255, 0, 255, 255, 255, 0, 255, 255 },
		{ 0, 255, 255, 255, 255, 255, 0, 255 },
		{ 0, 255, 255, 255, 255, 255, 0, 255 },
		{ 0, 255, 255, 255, 255, 255, 0, 255 },
		{ 255, 0, 255, 255, 255, 0, 255, 255 },
		{ 255, 255, 0, 0, 0, 255, 255, 255 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 }
	},

	{
		{ 0, 0, 0, 0, 255, 255, 255, 255 },
		{ 0, 0, 0, 0, 0, 0, 255, 255 },
		{ 0, 0, 0, 0, 0, 255, 0, 255 },
		{ 0, 255, 255, 255, 255, 0, 0, 255 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 255, 0, 0 },
		{ 0, 255, 0, 0, 0, 255, 0, 0 },
		{ 0, 255, 0, 0, 0, 255, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 255, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 0, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 255, 255, 0, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 0, 0, 255, 255, 255, 255, 0, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 255, 255, 255, 0, 0, 255, 0, 0 },
		{ 255, 255, 0, 255, 255, 255, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 255, 0, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 255, 255, 255, 0, 255, 255, 255, 0 },
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 255, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 255, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 0, 0, 0, 255 },
		{ 0, 255, 0, 0, 0, 0, 255, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 255, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 255, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 255 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 255 },
		{ 0, 0, 0, 0, 0, 0, 255, 0 },
		{ 0, 0, 0, 0, 0, 255, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 255, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 255, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 255 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 255, 255, 255 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 255, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 }
	},

	{
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 255, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 255, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 255, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 255, 255, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 255, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 255, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 0, 255, 0, 0, 0 },
		{ 255, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 255, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 255, 0, 0, 0 },
		{ 0, 255, 255, 255, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 255, 255, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 255, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 0, 0, 255, 0, 0, 0, 0, 0 },
		{ 255, 255, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	},

	{
		{ 0, 255, 0, 0, 0, 0, 0, 0 },
		{ 255, 0, 255, 0, 255, 0, 0, 0 },
		{ 0, 0, 0, 255, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 },
		{ 0, 0, 0, 0, 0, 0, 0, 0 }
	}

};

void find_text_dim(const char *const in, int *const n_lines, int *const n_cols)
{
	*n_lines = 1;
	*n_cols = 0;

	const int len = strlen(in);
	int cur_ll = 0;

	for(int i=0; i<len; i++) {
		if (in[i] == '\\' && in[i + 1] == 'n') {
			if (cur_ll > *n_cols)
				*n_cols = cur_ll;

			(*n_lines)++;
			cur_ll = 0;
			i++;
		}
		else {
			cur_ll++;
		}
	}

	if (cur_ll > *n_cols)
		*n_cols = cur_ll;
}

void replace_int(meta *const m, std::string *const work, const std::string & key)
{
	std::pair<uint64_t, int> val;

	if (!m -> get_int(key, &val))
		return;

	work -> assign(search_replace(*work, key, myformat("%d", val.second)));
}

void replace_double(meta *const m, std::string *const work, const std::string & key)
{
	std::pair<uint64_t, double> val;

	if (!m -> get_double(key, &val))
		return;

	work -> assign(search_replace(*work, key, myformat("%f", val.second)));
}

std::string unescape(const std::string & in, const uint64_t ts, instance *const i, interface *const specific_int, const std::map<std::string, feed *> & text_feeds)
{
	uint64_t get_feed_ts = 0;

	time_t now = (time_t)(ts / 1000 / 1000);
	struct tm ptm;
	localtime_r(&now, &ptm);

	int len = in.size();
	int bytes = len + 4096;

	char *text_out = (char *)malloc(bytes);
	if (!text_out)
		error_exit(true, "out of memory while allocating %d bytes", bytes);

	std::string work_in = ts == 0 ? search_replace(in, "%c", "-unknown-") : in;

	strftime(text_out, bytes, work_in.c_str(), &ptm);

	std::string work = text_out;
	free(text_out);

	std::string us_str = myformat("%06ld", ts % 1000000);
	work = search_replace(work, "%f", us_str);

	std::string iso_ts = myformat("%04d-%02d-%02d %02d:%02d:%02d.%03d",
			ptm.tm_year + 1900, ptm.tm_mon + 1, ptm.tm_mday,
			ptm.tm_hour, ptm.tm_min, ptm.tm_sec,
			(ts / 1000) % 1000);

	work = search_replace(work, "$isots$", iso_ts);

	meta *m = nullptr;
	source *s = specific_int ? static_cast<source *>(specific_int) : find_source(i);
	if (s) {
		m = s -> get_meta();

		work = search_replace(work, "$ts$", myformat("%.6f", ts / 1000000.0));

		replace_int(m, &work, "$http-viewers$");
		replace_int(m, &work, "$vnc-viewers$");
		replace_double(m, &work, "$pixels-changed$");
		work = search_replace(work, "$width$", myformat("%d", s -> get_width()));
		work = search_replace(work, "$height$", myformat("%d", s -> get_height()));
		if (s -> get_descr().empty() && i)
			work = search_replace(work, "$descr$", i -> name);
		else
			work = search_replace(work, "$descr$", s -> get_descr());
		work = search_replace(work, "$id$", s -> get_id());

		auto fps = s->get_fps();
		if (fps.has_value())
			work = search_replace(work, "$fps$", myformat("%.2f", fps.value()));

		if (s->get_class_type() == CT_VIEW)
			work = search_replace(work, "$view-id$", ((view *)s)->get_current_source()->get_id());
	}
	else if (i) {
		work = search_replace(work, "$descr$", i -> name);
	}

	std::string motion_string;
	if (i && check_for_motion(i))
		motion_string = "MOTION DETECTED";
	work = search_replace(work, "$motion$", motion_string);
	work = search_replace(work, "$prog-name$", NAME);
	work = search_replace(work, "$prog-version$", VERSION);

	// find all other $...$ and search in meta
	size_t dollar1 = 0;

	for(;;) {
		dollar1 = work.find('$', dollar1);
		if (dollar1 == std::string::npos)
			break;

		size_t dollar2 = work.find('$', dollar1 + 1);
		if (dollar2 == std::string::npos)
			break;

		std::string name = work.substr(dollar1, dollar2 - dollar1 + 1);

		if (name.substr(0, 6) == "$exec:") {
			std::string replace_with_what;

			FILE *fh = exec(name.substr(6, name.size() - 7));
			if (fh) {
				char buffer[1024] = { 0 };
				bool fail = fgets(buffer, sizeof buffer, fh) == nullptr;
				pclose(fh);

				char *cr = strchr(buffer, '\r');
				if (cr)
					*cr = 0x00;
				char *lf = strchr(buffer, '\n');
				if (lf)
					*lf = 0x00;

				if (fail)
					replace_with_what = "(?)";
				else
					replace_with_what = buffer;
			}

			 work = search_replace(work, name, replace_with_what);
		}
		else if (name.substr(0, 6) == "$file:") {
			std::string replace_with_what;

			std::string filename = name.substr(6, name.size() - 7);

			FILE *fh = fopen(filename.c_str(), "r");
			if (fh) {
				char buffer[1024] = { 0 };
				bool fail = fgets(buffer, sizeof buffer, fh) == nullptr;
				fclose(fh);

				char *cr = strchr(buffer, '\r');
				if (cr)
					*cr = 0x00;
				char *lf = strchr(buffer, '\n');
				if (lf)
					*lf = 0x00;

				if (fail)
					replace_with_what = "(?)";
				else
					replace_with_what = buffer;
			}

			work = search_replace(work, name, replace_with_what);
		}
		else {
			std::pair<uint64_t, int> val_int;
			std::pair<uint64_t, double> val_double;
			std::pair<uint64_t, std::string> val_string;

			auto f = text_feeds.find(name.substr(1, name.size() - 2));

			if (m && m -> get_int(name, &val_int)) {
				work = search_replace(work, name, myformat("%d", val_int.second));
			}
			else if (m && m -> get_double(name, &val_double)) {
				work = search_replace(work, name, myformat("%f", val_double.second));
			}
			else if (m && m -> get_string(name, &val_string)) {
				work = search_replace(work, name, val_string.second);
			}
			else if (f != text_feeds.end()) {
				auto feed_text = f->second->wait_for_text(get_feed_ts, 99000);

				if (feed_text.has_value()) {
					work = search_replace(work, name, feed_text.value().first);

					get_feed_ts = feed_text.value().second;
				}
			}
			else {
				dollar1 = dollar2 + 1;
			}
		}
	}

	return work;
}

filter_add_text::filter_add_text(const std::string & whatIn, const pos_t tpIn, const std::map<std::string, feed *> & text_feeds) :
	what(whatIn),
	tp(tpIn),
	text_feeds(text_feeds)
{
}

filter_add_text::~filter_add_text()
{
}

void add_text(unsigned char *const img, const int width, const int height, const char *const text, const int xpos, const int ypos)
{
	int cx = 0, cy = 0;
	const int len = strlen(text);

	for(int loop=0; loop<len; loop++)
	{
		if (text[loop] == '\\' && text[loop + 1] == 'n') {
			cy++;
			cx = 0;
			loop++; // ignore 'n'
			continue;
		}

		if (text[loop] == '\n') {
			cy++;
			cx = 0;
			continue;
		}

		const int cur_char = text[loop] & 127;

		for(int y=0; y<8; y++) {
			const int realy = ypos + y + cy * 9;
			if (realy < 0)
				continue;

			if (realy >= height)
				break;

			const int y_offset = realy * width * 3;

			for(int x=0; x<8; x++) {
				int realx = xpos + x + 8 * cx;
				if (realx < 0)
					continue;

				if (realx >= width)
					break;

				int offset = y_offset + realx * 3;

				img[offset + 0] = font[cur_char][y][x];
				img[offset + 1] = font[cur_char][y][x];
				img[offset + 2] = font[cur_char][y][x];
			}
		}

		cx++;
	}
}

void print_timestamp(unsigned char *const img, const int width, const int height, const std::string & text, const pos_t n_pos, const uint64_t ts, instance *const i, interface *const specific_int, const std::map<std::string, feed *> & text_feeds)
{
	int x = 0, y = 0;

	std::string text_out = unescape(text, ts, i, specific_int, text_feeds);

	int n_lines = 0, max_ll = 0;
	find_text_dim(text_out.c_str(), &n_lines, &max_ll);

	if (n_pos.type == upper_left || n_pos.type == upper_center || n_pos.type == upper_right)
		y = 1;
	else if (n_pos.type == center_left || n_pos.type == center_center || n_pos.type == center_right)
		y = (height / 2) - 4;
	else if (n_pos.type == lower_left || n_pos.type == lower_center || n_pos.type == lower_right)
		y = height - 9 * n_lines;

	if (n_pos.type == upper_left || n_pos.type == center_left || n_pos.type == lower_left)
		x = 1;
	else if (n_pos.type == upper_center || n_pos.type == center_center || n_pos.type == lower_center)
		x = (width / 2) - (max_ll / 2) * 8;
	else if (n_pos.type == upper_right || n_pos.type == center_right || n_pos.type == lower_right)
		x = width - max_ll * 8;

	if (n_pos.type == xy || n_pos.type == axy) {
		x = n_pos.x;
		y = n_pos.y;

		if (n_pos.type == xy) {
			while (x < 0)
				x += width;
			while (y < 0)
				y += height;

			while (x >= width)
				x -= width;
			while (x >= height)
				x -= height;
		}
	}

	add_text(img, width, height, text_out.c_str(), x, y);
}

void filter_add_text::apply(instance *const i, interface *const specific_int, const uint64_t ts, const int w, const int h, const uint8_t *const prev, uint8_t *const in_out)
{
	print_timestamp(in_out, w, h, what, tp, ts, i, specific_int, text_feeds);
}
